# Simple_Nonlinear_TBS_Model
Abstract: Transcranial magnetic stimulation (TMS) is a non-invasive neurostimulation and neuromodulation technique that is widely applied in brain research and clinical applications. However, the optimal parameters of neuromodulating TMS protocols describing the specific rhythms, such as the number of pulses, frequency, and stimulation strength, are widely unknown. Improving previous rather limited and ad-hoc models, we aimed to investigate the dose-dependency of theta-burst stimulation (TBS) protocols with a more elaborate but still parsimonious quantitative model representing the non-linearities of the mechanisms of synaptic plasticity and metaplasticity during repetitive magnetic stimulation. Our model, which considers the interaction between facilitatory and inhibitory processes based on the Michaelisâ€“Menten kinetics, successfully reproduced results from TBS experiments and provided testable predictions for prolonged TBS protocols. Moreover, we suggested that the activation of kinases and phosphatases could be potential candidates for later TMS modelling research. Although this model still simplifies the complex dynamics of cellular and molecular processes, it offers a starting basis for future studies to incorporate more intricate mechanisms. By further refining our understanding of the underlying mechanisms and improving the accuracy of prediction models, we can advance the efficacy and clinical application of TBS protocols in various neurological and psychiatric conditions. 
# Folder Summary
1. Figures: this folder contains all Figures used in this paper.
   * `PredictionPlots.pdf`: Time evolution of $M_\textrm{net}$ in responses to continuous application of cTBS and iTBS. A value of $M_\textrm{net} > 1$ means facilitatory effects on MEP, while $M_\textrm{net} < 1$ means inhibitory effects on MEP. The blue solid line corresponds to the iTBS protocol, and the solid red line corresponds to the cTBS protocol.
   * `cTBSAftereffectPlots.pdf`: Simulation results for cTBS with $300$, $600$, $1200$, and $1800$ pulses. (A) shows the calcium influx rate changes in response to the stimulus; (B) shows intracellular calcium concentration dynamics during the stimulation period; (C) shows the dynamics of facilitation and inhibition substances; (D) shows the net changes of MEP after stimulation; (E) shows the after-effect curve after cTBS300; (F) shows the after-effect curve after cTBS600; (G) shows the after-effect curve after cTBS1200; (H) shows the after-effect curve after cTBS1800. In panels (E) to (H), red dots represent the mean value of MEPs measured at specific time points, with red error bars indicating the corresponding standard deviations, and the blue curves represent simulated after-effect curves.
   * `iTBSAftereffectPlots.pdf`: Simulation results for iTBS with $600$, $1200$, and $1800$ pulses. (A) shows the calcium influx rate changes in response to the stimulus; (B) shows intracellular calcium concentration dynamics during the stimulation period; (C) shows the dynamics of facilitation and inhibition substances; (D) shows the net changes in MEP after stimulation; (E) shows the after-effect curve after iTBS600; (F) shows the after-effect curve after iTBS1200; and (G) shows the after-effect curve after iTBS1800. In panels (E) to (G), red dots represent the mean value of MEPs measured at specific time points, with red bars indicating the corresponding standard deviations, and the blue curves represent simulated after-effect curves.
   * `substanceRate.pdf`: Production rates of facilitation and inhibition substances depending on the intracellular calcium concentration $[Ca^\textrm{2+}]_\textrm{i}$.
2. Functions: this folder contains all functions used for plotting figures and simulating ODE systems.
   * `aftereffectCurve.m`: this script aims to calculate the after-effect curves for TBS.
   * `calciumDynamics.m`: this script contains the ODE systems given in this paper in the \textbf{Mathematical Model} section.
   * `impulseTrainGen.m`: this script aims to generate a series of pulses with a given frequency and burst.
   * `odeRK4.m`: this script implements the fourth-order Runge---Kutta method.
   * `simFuntion_ODE.m`: this script aims to calculate the simulation results for a given input protocol.
3. Supplementary document: this PDF document contains all studies used for data collection.
# Main Functions
1. `PredictionPlot.m`: this script aims to plot `PredictionPlots.pdf`.
2. `SubstanceRatePlot.m`: this script aims to plot `substanceRate.pdf`.
3. `cTBS_AftereffectPlots.m` and `iTBS_AftereffectPlots.m`: these scripts aim to plot `cTBSAftereffectPlots.pdf` and `iTBSAftereffectPlots.pdf` respectively.
4. `opti_GPW_Final.mat`: this `.mat` file contains the calibrated parameters for this model.
